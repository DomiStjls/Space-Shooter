# Пояснительная записка

## Название:
Space Shooter

## Авторы:
Дарья Шевченко, Харалмов Максим

## Описание идеи
Space Shooter - это аркадный шутер, который погружает вас в захватывающий мир космических сражений. Вы - пилот космического истребителя, ваша задача - лететь через астероидные поля, сбивать врагов, защищать свой карабль и выполнять различные миссии.
 Вы должны уничтожить все астероиды и врагов на своем пути. 
 Используйте свой корабль, чтобы маневрировать между астероидами и уничтожать их с помощью ракет и лазерных пушек. Чем больше врагов вы уничтожите, тем больше очков и наград заработаете.

## Описание реализации
#### Все спрайты разделены на группы:

- _player_group_ - группа игрока
- _enemy_group_ - группа с врагами
- _bullet_group_ - группа со всеми пулями
- _player_bullets_ - группа с пулями игрока
- _enemy_bullets_ - группа с вражескими пулями
- _presents_group_ - группа с подарками
- _animation_group_ - группа с анимациями взрыва убитых врагов

#### Уровни в игре хранятся в закодированном виде:

- цифра от 0 до 2 - обозначает тип врага на данной позиции
- точка - пустое место

#### хранение настроек спрайтов

Все настройки хранятся в списке из кортежей, каждый кортеж хранит данные определенного типа персонажей\
Формат кортежа типа врага:\
тип врага, картинка врага, картинка пули, папка с анимацией, время между выстрелами, список скоростей для каждой из
пуль (по X и по Y), очки за убийство врага\
Формат кортежа типа игрока:\
тип игрока, картинка игрока, картинка пули, время между выстрелами, скорости пуль (список кортежей, описывающих скорости
каждой пули по обоим осям)\
Формат кортежа подарка:\
тип подарка, изображение подарка, скорость (по X и Y)

#### _start_game_

1) перед каждым уровнем заново создаются группы спрайтов, обнуляются очки
2) Происходит загрузка уровня из текстового файла
3) Создаются необходимые спрайты, в том числе спрайт игрока
4) Запускается игровой цикл
5) Игра выходит из игрового цикла при смерти игрока, или если все враги убиты, и все анимации закончились

#### Игрок (класс _Player_)

- При инициализации в игрока предается его координата на поле (0, 0), в начале игры тип игрока 0.
- При столкновении с вражескими пулями, игра останавливается.
- При создании пуль, заданные скорости умножаются на определенный коэффициент, который меняется в процессе игры
- Метод _set_type_:\
  Метод записывает в игрока необходимую картинку, меняет необходимые параметры и вызывает метод _set_duration_.
- Метод _set_duration_:\
  Метод меняет таймер события стрельбы игрока.

#### Враги (класс _Enemy_)

- При инициализации передается позиция врага и его тип, загружаются необходимые картинки и записываются необходимые
  настройки, которое не изменяются в процессе игры.
- Смерть врагов\
  Когда во врага попадает пуля игрока, враг умирает.
  При этом удаляется событие его стрельбы, и сам объект врага удаляется из группы врагов(_enemy_group_).
  После смерти создается экземпляр класса _Animation_, которые проигрывает анимацию взрыва врага, при этом никак не
  взаимодействует с другими спрайтами.
  После смерти каждого врага создается экземпляр класса _Present_.
- При стрельбе врага создается необходимое количество пуль с заданными параметрами.

#### Пули (класс _Bullet_)

- При инициализации передается координата начала, имя файла с изображением, чья пуля(параметр whose: 0 - вражеская пуля;
  1 - пуля игрока) и скорости по двум осям.\
  Все пули попадают в группу _bullet_group_. Вражеские пули также попадают в группу _enemy_bullets_, а пули игрока в
  группу _player_bullets_.
- Пуля каждый кадр смещается на заданное количество пикселей, скорости не меняются.
- Если пуля вышла за границы экрана, она удаляется из всех групп

#### Стрельба персонажей

При инициализации спрайтов игрока и врагов создается событие. События хранятся в списке _events_.
При "срабатывании" события вызывается метод _shoot_ у соответствующего спрайта.
События хранятся в специальном словаре, ключами которого являются номера событий, а значениями сами объекты.
При смерти персонажа, его событие удаляется, а также удаляется элемент в словаре с этим событием. \
Метод _shoot_ создает необходимое количество пуль с необходимыми скоростями.

#### Подарки(класс _Present_)

- При инициализации подарка в него передается номер(от 0 до 10):

0) меняет тип игрока на 0 (метод _set_type_ в классе _Player_)
1) меняет тип игрока на 1 (метод _set_type_ в классе _Player_)
2) меняет тип игрока на 2 (метод _set_type_ в классе _Player_)
3) увеличивает скорость пуль игрока (изменяет параметр _k_ у объекта игрока)
4) уменьшает задержку между пулями игрока (метод _set_duration_ в классе _Player_)\

Если номера нет в списке, то подарок не создается. То есть, подарки выпадают не из каждого врага.\

- Подарки движутся с постоянной скоростью вниз.
- При выходе подарка за границы экрана, он удаляется из группы _presents_group_.

#### Анимации(класс _Animation_)

- При инициализации передается имя папки с анимацией, координаты для анимации. Затем все картинки загружаются в список
  images.
- Внутри папки картинки должны называть 1.png, 2.png, 3.png, ... , n.png (где n - количество картинок)
- При каждой смене кадра картинка спрайта меняется на следующую из списка images. Если картинок больше нет, то спрайт
  удаляется из группы _animation_group_ и больше не обновляется и не рисуется.
- Спрайты с анимацией никак не взаимодействуют с другими спрайтами(не обрабатывают столкновения)



#### База данных

База данных создается в самом начале программы в самый первый запуск. С ней можно взаимодействовать через 3 функции:

- `findpers(n)` - поиск игрока с именем n для входа в аккаунт
- `makepers(n)` - создание игрока с именем n
- `update(n, s)` - обновление очков

Вся работа с базой данных выполнена через модуль **sqlite3**. База состоит из одной таблицы.

#### Основной цикл игры

`start_window()` - главная функция, которая запускает игру. В программе использован один цикл __while__. 
В нем есть разделение на разные экраны.
Есть 5 переменных, обозначающих нахождения на определенном экране. В начале игры заданы параметры:
-    is_main_window = True
-    is_data_window = False
-    is_levels_window = False
-    is_settings_window = False
-    win = False
  
В зависимости от этого есть 5 разных цикла-обработчиков событий:
1) На главном экране есть 3 кнопки, через которые осуществляется переход с одного экрана на другой.\
   На этом экране есть динамичный фон. Каждая из звезд лежит в одной из групп
   (**star_field_slow**, **star_field_medium**, **star_field_fast**). С каждым шагом цикла **for** они обновляют свое положение.\
   Распознавание нажатий выполнено с помощью метода __collidepoint__ (Анологично на всех остальных экранах).
   Оно меняет значение флагов нахождения на каком-либо экране. То есть тот, на котором человек становится равен False, а тот,
   на который человек переходит, становится равен True.
   Также если звук клавиш не выключен в настройках при нажатии проигрывается звук нажатия на клавишу.

2) На экране с входом в аккаунт есть строка для ввода, кнопки входа/создания аккаунта и возвращения на главный экран,
   а также окно для показа информации о игроке.\
   Строка ввода сделана через вывод вводимого символа и запоминания его. Когда пользователь вводит букву, она добавляется в
   переменную user_text и при нажатии кнопок входа/создания аккаунта, вызывается соответствующая функция.

3) На экране с входом в уровни имеются только кнопки. Их работа описана ранее.\
4) На экране настроек есть 2 кнопки для включения/выключения звука и рейтинг игроков.
5) На экране после победы/проигрыша есть кнопка и карточка с информацией о прохождении уровня.

## Описание технологий
Программа написана на языке python, с использованием библиотеки pygame

## Скриншоты
![image](https://github.com/DomiStjls/Space-Shooter/assets/101044403/fd37af61-bcdf-423b-be0d-496fe5ea8dc4)
![image](https://github.com/DomiStjls/Space-Shooter/assets/101044403/30502865-865e-43d7-a6c7-0c2fafb89943)
![image](https://github.com/DomiStjls/Space-Shooter/assets/101044403/09a4117b-dae9-4bd1-beae-a25b4fff53bc)
